{
	"lex": {
		"rules": [
			["\\s",										"/* skip whitespace */"],
			["//",										"/* one line comment */"],
			["\\\\/\\\\*(.|\\n|\\r)*?\\\\*\\\\/",		"/* block comment */"],
			["\\<\\/",									"return '</';"],
			["\\/\\>",									"return '/>';"],
			["<=",										"return '<=';"],
			[">=",										"return '>=';"],
			["\\<",										"return '<';"],
			["\\>",										"return '>';"],
			["\\{",										"return '{';"],
			["\\}",										"return '}';"],
			["\\[",										"return '[';"],
			["\\]",										"return ']';"],
			["\\(",										"return '(';"],
			["\\)",										"return ')';"],
			["\\:",										"return ':';"],
			["\\.",										"return '.';"],
			["\\,",										"return ',';"],
			["\\;",										"return ';';"],
			["\\+",										"return '+';"],
			["\\-",										"return '-';"],
			["\\*",										"return '*';"],
			["\\/",										"return '/';"],
			["\\%",										"return '%';"],
			["\\^",										"return '^';"],
			["\\=",										"return '=';"],
			["\\'[^\\\\']*\\'",							"return 'ASTRING';"],
			["\\\"[^\\\\\"]*\\\"",						"return 'QSTRING';"],
			["\\`[^\\\\`]*\\`",							"return 'BSTRING';"],
			["let\\b",									"return 'LET';"],
			["public\\b",								"return 'PUBLIC';"],
			["protected\\b",							"return 'PROTECTED';"],
			["private\\b",								"return 'PRIVATE';"],
			["true\\b",									"return 'TRUE';"],
			["false\\b",								"return 'FALSE';"],
			["return\\b",								"return 'RETURN';"],
			["is\\b",									"return 'IS';"],
			["isnt\\b",									"return 'ISNT';"],
			["lt\\b",									"return 'LT';"],
			["gt\\b",									"return 'GT';"],
			["gteq\\b",									"return 'GTEQ';"],
			["lteq\\b",									"return 'LTEQ';"],
			["&&\\b",									"return 'AND';"],
			["and\\b",									"return 'AND';"],
			["\\|\\|\\b",								"return 'OR';"],
			["or\\b",									"return 'OR';"],
			["!\\b",									"return '!';"],
			["[0-9]+(?:\\.[0-9]+)?\\b",					"return 'NUMBER';"],
			["[a-zA-Z_][a-zA-Z0-9_]*", 					"return 'IDENTIFIER';"],
			["$",										"return 'EOF';"]
		]
	},
	"tokens": "LET TRUE FALSE IDENTIFIER NUMBER LET PRIVATE PROTECTED PUBLIC RETURN",
	"operators": [
		["left", "RETURN"],
		["left", "=", ":"],
		["left", "AND", "OR"],
		["left", "IS", "ISNT", "GT", "LT", "GTEQ", "LTEQ"],
		["left", "!"],
		["left", "+", "-"],
		["left", "*", "/"],
		["left", "^"],
		["left", "."],
		["right", "{", "}"],
		["right", "[", "]"],
		["right", "(", ")"],
		["right", "<", ">", "</", "/>"],
		["right", "UMINUS"],
		["right", ";"]
	],
	"start": "program",
	"bnf": {
		"array": [
			["arrayStart ]",
				"$$ = new yy.scopeAst(yy, 'arrayExpression', [$1]);"],
			["arrayStart associativeList ]",
				"$$ = new yy.scopeAst(yy, 'arrayExpression', [$1, $2]);"],
			["arrayStart expressionList ]",
				"$$ = new yy.scopeAst(yy, 'arrayExpression', [$1, $2]);"]
		],

		"arrayStart" : [
			["[",
				"$$ = new yy.scopeAst(yy, 'arrayStart', []);"]
		],

		"associativeDeclaration": [
			["IDENTIFIER : expression",
				"$$ = new yy.scopeAst(yy, 'associativeDeclaration', [$1, 'id', $3]);"],
			["string : expression",
				"$$ = new yy.scopeAst(yy, 'associativeDeclaration', [$1, 'string', $3]);"]
		],
		"associativeList": [
			["associativeDeclaration",
				"$$ = new yy.scopeAst(yy, 'associativeList', [$1]);"],
			["associativeList , associativeDeclaration",
				"$$ = new yy.scopeAst(yy, 'associativeList', [$1, $3]);"]
		],
		"binaryExpression": [
			["expression AND expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '&&', $3]);"],
			["expression OR expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '||', $3]);"],
			["expression IS expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '===', $3]);"],
			["expression ISNT expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '!==', $3]);"],
			["expression GT expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '>', $3]);"],
			["expression LT expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '<', $3]);"],
			["expression GTEQ expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '>=', $3]);"],
			["expression LTEQ expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, '<=', $3]);"],
			["expression + expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, $2, $3]);"],
			["expression - expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, $2, $3]);"],
			["expression * expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, $2, $3]);"],
			["expression / expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, $2, $3]);"],
			["expression ^ expression",
				"$$ = new yy.scopeAst(yy, 'binaryExpression', [$1, $2, $3]);"]
		],
		"controlCode": [
			["", 
				"return;"],
			["controlCode expression ;", 
				"$$ = new yy.scopeAst(yy, 'controlCode', [$1, $2]);"]
		],
		"declarationExpression": [
			["LET IDENTIFIER = expression",
				"$$ = new yy.scopeAst(yy, 'declarationExpression', ['let', $2, $4]);"],
			["PRIVATE IDENTIFIER = expression",
				"$$ = new yy.scopeAst(yy, 'declarationExpression', ['private', $2, $4]);"],
			["PROTECTED IDENTIFIER = expression",
				"$$ = new yy.scopeAst(yy, 'declarationExpression', ['protected', $2, $4]);"],
			["PUBLIC IDENTIFIER = expression",
				"$$ = new yy.scopeAst(yy, 'declarationExpression', ['public', $2, $4]);"]
		],
		"expression": [
			["id = expression",
				"$$ = new yy.scopeAst(yy, 'assignmentExpression', [$1, $3]);"],
			["declarationExpression",
				"$$ = $1"],
			["binaryExpression", 
				"$$ = $1"],
			["- expression",
				"$$ = '- $2';",
				{"prec": "UMINUS"}],
			["( expression )",
				"$$ = $2"],
			["literal", 
				"$$ = $1"],
			["id",
				"$$ = $1"],
			["invoke",
				"$$ = $1"],
			["RETURN expression",
				"$$ = new yy.scopeAst(yy, 'returnExpression', [$2]);"],
			["! expression",
				"$$ = '! $2';"]
		],
		"expressionList": [
			["expression", 
				"$$ = new yy.scopeAst(yy, 'expressionList', [$1]);"],
			["expression , expressionList", 
				"$$ = new yy.scopeAst(yy, 'expressionList', [$1, $3]);"]
		],
		"id": [
			["IDENTIFIER",
				"$$ = new yy.scopeAst(yy, 'identifier', [$1]);"],
			["id . IDENTIFIER",
				"$$ = new yy.scopeAst(yy, 'identifier', [$1, 'dot', $3]);"],
			["id [ expression ]",
				"$$ = new yy.scopeAst(yy, 'identifier', [$1, 'bracket', $3]);"]
		],
		"invoke": [
			["id ( invokeArguments )",
				"$$ = new yy.scopeAst(yy, 'invokeExpression', [$1, $3]);"],
			["scope ( invokeArguments )",
				"$$ = new yy.scopeAst(yy, 'invokeExpression', [$1, $3]);"],
			["invoke . id",
				"$$ = new yy.scopeAst(yy, 'invokeId', [$1, 'dot', $3]);"],
			["invoke [ expression ]",
				"$$ = new yy.scopeAst(yy, 'invokeId', [$1, 'bracket', $3]);"],
			["invoke ( invokeArguments )",
				"$$ = new yy.scopeAst(yy, 'invokeExpression', [$1, $3]);"]
		],
		"invokeArguments": [
			["",
				"$$ = new yy.scopeAst(yy, 'invokeArguments', []);"],
			["expressionList",
				"$$ = new yy.scopeAst(yy, 'invokeArguments', [$1]);"]
		],
		"literal": [
			["TRUE",
				"$$ = new yy.scopeAst(yy, 'booleanLiteral', true);"],
			["FALSE",
				"$$ = new yy.scopeAst(yy, 'booleanLiteral', false);"],
			["NUMBER",
				"$$ = new yy.scopeAst(yy, 'numericLiteral', Number($1));"],
			["string",
				"$$ = new yy.scopeAst(yy, 'stringLiteral', $1.substr(1,$1.length-2));"],
			["xml",
				"$$ = $1"],
			["scope",
				"$$ = $1"],
			["array",
				"$$ = $1"]
		],
		"program": [
			["controlCode EOF", "return $1"]
		],
		"scope": [
			["scopeArguments scopeStart controlCode }",
				"$$ = new yy.scopeAst(yy, 'scopeExpression', [$scopeStart, $scopeArguments, $controlCode]);"],
			["scopeStart controlCode }",
				"$$ = new yy.scopeAst(yy, 'scopeExpression', [$scopeStart, $controlCode]);"]
		],
		"scopeStart": [
			["{",
				"$$ = new yy.scopeAst(yy, 'scopeStart', []);"]
		],
		"scopeArguments": [
			["( associativeList )",
				"$$ = new yy.scopeAst(yy, 'scopeArguments', [$2]);"]
		],
		"string": [
			["QSTRING", 
				"$$ = $1"],
			["ASTRING",
				"$$ = $1"],
			["BSTRING",
				"$$ = $1"]
		],
		"xml": [
			["< id xmlAttributes > xmlControlCode </ id >",
				"$$ = new yy.scopeAst(yy, 'xmlExpression', [$2, $3, $5]);"],
			["< id xmlAttributes />",
				"$$ = new yy.scopeAst(yy, 'xmlExpression', [$2, $3]);"]
		],
		"xmlAttributes": [
			["", 
				"$$ = new yy.scopeAst(yy, 'xmlAttributes', []);"],
			["xmlAttributes id = expression",
				"$$ = new yy.scopeAst(yy, 'xmlAttributes', [$1, $2, $4]);"]
		],
		"xmlControlCode": [
			["",
				"$$ = new yy.scopeAst(yy, 'xmlControlCode', []);"],
			["xmlControlCode expression ;",
				"$$ = new yy.scopeAst(yy, 'xmlControlCode', [$1, $2]);"]
		]
	}
}