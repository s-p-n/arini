#!/usr/bin/env node
"use strict";global.__scopedir=__dirname;require("source-map-support").install();const scope=require("/home/spence/Projects/scope/lib/scopeRuntime.js");const ScopeApi=require("/home/spence/Projects/scope/lib/scopeRuntimeApi.js")(scope);module.exports=scope.createScope(function(args){ScopeApi.createTag("Square",scope.createScope(function(args){scope.declarationExpression({type:"let",name:"attr",value:args[0]===undefined?scope.mapExpression():args[0]});scope.declarationExpression({type:"let",name:"children",value:args[1]===undefined?scope.mapExpression():args[1]});scope.declarationExpression({type:"public",name:"listeners",value:scope.mapExpression(["click",scope.identifier("attr")["onClick"]])});scope.declarationExpression({type:"public",name:"render",value:scope.createScope(function(args){return scope.xmlExpression("button",{"class":"square"},scope.identifier("attr")["value"]);})});}));ScopeApi.createTag("Board",scope.createScope(function(args){scope.declarationExpression({type:"let",name:"attr",value:args[0]===undefined?scope.mapExpression():args[0]});scope.declarationExpression({type:"public",name:"renderSquare",value:scope.createScope(function(args){scope.declarationExpression({type:"let",name:"i",value:args[0]===undefined?0:args[0]});return scope.xmlExpression("Square",{"value":scope.identifier("attr")["squares"][[scope.identifier("i")]], "onClick":scope.identifier("attr")["onClick"](scope.identifier("i"))});})});scope.declarationExpression({type:"public",name:"render",value:scope.createScope(function(args){return scope.xmlExpression("div",{},scope.xmlExpression("div",{"class":"board-row"},scope.identifier("renderSquare")(0),scope.identifier("renderSquare")(1),scope.identifier("renderSquare")(2)),scope.xmlExpression("div",{"class":"board-row"},scope.identifier("renderSquare")(3),scope.identifier("renderSquare")(4),scope.identifier("renderSquare")(5)),scope.xmlExpression("div",{"class":"board-row"},scope.identifier("renderSquare")(6),scope.identifier("renderSquare")(7),scope.identifier("renderSquare")(8)));})});}));ScopeApi.createTag("jumpTo",scope.createScope(function(args){scope.declarationExpression({type:"let",name:"attr",value:args[0]===undefined?scope.mapExpression():args[0]});scope.declarationExpression({type:"let",name:"children",value:args[1]===undefined?scope.mapExpression():args[1]});scope.declarationExpression({type:"public",name:"listeners",value:scope.mapExpression(["click",scope.identifier("attr")["onClick"]])});scope.declarationExpression({type:"public",name:"render",value:scope.createScope(function(args){return scope.xmlExpression("button",{},scope.identifier("children")[[0]]);})});}));ScopeApi.createTag("Game",scope.createScope(function(args){scope.declarationExpression({type:"public",name:"state",value:scope.mapExpression(["history",scope.arrayExpression(scope.mapExpression(["squares",scope.binaryExpression('*', scope.arrayExpression(""), 9)]))],["activePlayer","X"],["stepNumber",0])});scope.declarationExpression({type:"let",name:"getWinner",value:scope.createScope(function(args){scope.declarationExpression({type:"let",name:"squares",value:args[0]===undefined?scope.mapExpression():args[0]});scope.declarationExpression({type:"let",name:"lines",value:scope.arrayExpression(scope.arrayExpression(0,1,2),scope.arrayExpression(3,4,5),scope.arrayExpression(6,7,8),scope.arrayExpression(0,3,6),scope.arrayExpression(1,4,7),scope.arrayExpression(2,5,8),scope.arrayExpression(0,4,8),scope.arrayExpression(2,4,6))});scope.declarationExpression({type:"let",name:"result",value:""});ScopeApi['each'](scope.identifier("lines"),scope.createScope(function(args){scope.declarationExpression({type:"let",name:"line",value:args[0]===undefined?scope.mapExpression():args[0]});scope.declarationExpression({type:"let",name:"index",value:args[1]===undefined?0:args[1]});scope.declarationExpression({type:"let",name:"break",value:args[2]===undefined?scope.createScope(function(args){}):args[2]});scope.declarationExpression({type:"let",name:["a","b","c"],value:scope.identifier("line")});ScopeApi['if'](scope.binaryExpression('&&', scope.binaryExpression('&&', scope.binaryExpression('!==', scope.identifier("squares")[[scope.identifier("a")]], ""), scope.binaryExpression('===', scope.identifier("squares")[[scope.identifier("a")]], scope.identifier("squares")[[scope.identifier("b")]])), scope.binaryExpression('===', scope.identifier("squares")[[scope.identifier("a")]], scope.identifier("squares")[[scope.identifier("c")]])),scope.createScope(function(args){scope.assignmentExpression(["result"],["=", scope.identifier("squares")[[scope.identifier("a")]]]);scope.identifier("break")();}));}));return scope.identifier("result");})});scope.declarationExpression({type:"let",name:"jumpTo",value:scope.createScope(function(args){scope.declarationExpression({type:"let",name:"step",value:args[0]===undefined?0:args[0]});scope.identifier("setState")(scope.mapExpression(["stepNumber",scope.identifier("step")],["activePlayer",ScopeApi['if'](scope.binaryExpression('===', scope.binaryExpression('%', scope.identifier("step"), 2), 0),scope.createScope(function(args){return "X";}),scope.createScope(function(args){return "O";}))]));})});scope.declarationExpression({type:"public",name:"handleClick",value:scope.createScope(function(args){scope.declarationExpression({type:"let",name:"i",value:args[0]===undefined?0:args[0]});scope.declarationExpression({type:"let",name:"history",value:scope.identifier("state")["history"].slice(0,scope.binaryExpression('+', scope.identifier("state")["stepNumber"], 1))});scope.declarationExpression({type:"let",name:"current",value:scope.identifier("history")[[scope.binaryExpression('-', scope.identifier("history")["size"], 1)]]});scope.declarationExpression({type:"let",name:"squares",value:scope.identifier("current")["squares"].slice(0,undefined)});return scope.createScope(function(args){scope.declarationExpression({type:"let",name:"e",value:args[0]===undefined?scope.mapExpression():args[0]});ScopeApi['if'](scope.binaryExpression('&&', scope.binaryExpression('===', scope.identifier("squares")[[scope.identifier("i")]], ""), scope.binaryExpression('===', scope.identifier("getWinner")(scope.identifier("squares")), "")),scope.createScope(function(args){scope.assignmentExpression([scope.identifier("squares"),[scope.identifier("i")]],["=", scope.identifier("state")["activePlayer"]]);scope.assignmentExpression(["history"],["+=", scope.mapExpression(["squares",scope.identifier("squares")])]);scope.identifier("setState")(scope.mapExpression(["history",scope.identifier("history")],["activePlayer",ScopeApi['if'](scope.binaryExpression('===', scope.identifier("state")["activePlayer"], "X"),scope.createScope(function(args){return "O";}),scope.createScope(function(args){return "X";}))],["stepNumber",scope.binaryExpression('-', scope.identifier("history")["size"], 1)]));}));});})});scope.declarationExpression({type:"public",name:"render",value:scope.createScope(function(args){scope.declarationExpression({type:"let",name:"history",value:scope.identifier("state")["history"]});scope.declarationExpression({type:"let",name:"current",value:scope.identifier("history")[[scope.identifier("state")["stepNumber"]]]});scope.declarationExpression({type:"let",name:"winner",value:scope.identifier("getWinner")(scope.identifier("current")["squares"])});scope.declarationExpression({type:"let",name:"moves",value:ScopeApi['each'](scope.identifier("history"),scope.createScope(function(args){scope.declarationExpression({type:"let",name:"val",value:args[0]===undefined?scope.mapExpression():args[0]});scope.declarationExpression({type:"let",name:"move",value:args[1]===undefined?0:args[1]});scope.declarationExpression({type:"let",name:"desc",value:ScopeApi['if'](scope.identifier("move"),scope.createScope(function(args){return scope.binaryExpression('+', "Go to move #", scope.identifier("move"));}),scope.createScope(function(args){return "Go to game start";}))});return scope.xmlExpression("li",{},scope.xmlExpression("jumpTo",{"onClick":scope.createScope(function(args){scope.identifier("jumpTo")(scope.identifier("move"));})},scope.identifier("desc")));}))});scope.declarationExpression({type:"let",name:"status",value:ScopeApi['if'](scope.binaryExpression('!==', scope.identifier("winner"), ""),scope.createScope(function(args){return scope.binaryExpression('+', "Winner: ", scope.identifier("winner"));}),scope.createScope(function(args){return scope.binaryExpression('+', "Next Player: ", scope.identifier("state")["activePlayer"]);}))});return scope.xmlExpression("div",{"class":"game"},scope.xmlExpression("div",{"class":"game-board"},scope.xmlExpression("Board",{"squares":scope.identifier("current")["squares"], "onClick":scope.identifier("handleClick")})),scope.xmlExpression("div",{"class":"game-info"},scope.xmlExpression("div",{},scope.identifier("status")),scope.xmlExpression("ol",{},scope.identifier("moves"))));})});}));return ScopeApi.getAllTags();})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3NwZW5jZS9Qcm9qZWN0cy9zY29wZS90ZXN0L2h1bWFuVGVzdHMvdGljVGFjVG9lL3RhZ3Muc2MiXSwibmFtZXMiOlsiPGFub255bW91c2U+IiwiY3JlYXRlVGFnIiwiaW52b2tlRXhwcmVzc2lvbiIsImdldEFsbFRhZ3MiXSwibWFwcGluZ3MiOiJBQWtJa0JBO0FBQUFBLDRSQWxJVEMsa0JBSUZDLENBSldGLFFBSVhBLGtRQUh5QkEsdUlBR3pCQSxpTUFBQUUsQ0FBQUYsQ0FLRUMsa0JBdUJTQyxDQXZCREYsT0F1QkNBLGdKQW5CT0Esb1hBbUJQQSxtbUJBQUFFLENBQUFGLENBTVRDLGtCQUdrQkMsQ0FIVEYsUUFHU0Esa1FBRktBLHVJQUVMQSxpTEFBQUUsQ0FBQUYsQ0FJbEJDLGtCQStFSUMsQ0EvRUdGLE1BK0VIQSxrQ0F4RVpBLHlQQXFCY0Esb3NEQU04Q0EsaWZBZ0J6REEsMnBEQTZCU0EsOC9EQUFBRSxDQUFBRixDQU1LQSxPQUFERyxtQkFBQ0QsRUFBQUYsR0FBQUUsRUFBQUYiLCJzb3VyY2VzQ29udGVudCI6WyJjcmVhdGVUYWcoXCJTcXVhcmVcIiwgKGF0dHI6IFtdLCBjaGlsZHJlbjogW10pIHtcblx0cHVibGljIGxpc3RlbmVycyA9IFtjbGljazogYXR0ci5vbkNsaWNrXTtcblx0cHVibGljIHJlbmRlciA9IHtcblx0XHRyZXR1cm4gPGJ1dHRvbiBjbGFzcz1cInNxdWFyZVwiPlxuXHRcdFx0YXR0ci52YWx1ZTtcblx0XHQ8L2J1dHRvbj47XG5cdH07XG59KTtcblxuY3JlYXRlVGFnKFwiQm9hcmRcIiwgKGF0dHI6IFtdKSB7XG5cdHB1YmxpYyByZW5kZXJTcXVhcmUgPSAoaTogMCkge1xuXHRcdHJldHVybiA8U3F1YXJlIFxuXHRcdFx0dmFsdWU9YXR0ci5zcXVhcmVzW2ldIFxuXHRcdFx0b25DbGljaz1hdHRyLm9uQ2xpY2soaSkgXG5cdFx0Lz47XG5cdH07XG5cblx0cHVibGljIHJlbmRlciA9IHtcblx0XHRyZXR1cm4gPGRpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJib2FyZC1yb3dcIj5cblx0XHRcdFx0cmVuZGVyU3F1YXJlKDApO1xuXHRcdFx0XHRyZW5kZXJTcXVhcmUoMSk7XG5cdFx0XHRcdHJlbmRlclNxdWFyZSgyKTtcblx0XHRcdDwvZGl2Pjtcblx0XHRcdDxkaXYgY2xhc3M9XCJib2FyZC1yb3dcIj5cblx0XHRcdFx0cmVuZGVyU3F1YXJlKDMpO1xuXHRcdFx0XHRyZW5kZXJTcXVhcmUoNCk7XG5cdFx0XHRcdHJlbmRlclNxdWFyZSg1KTtcblx0XHRcdDwvZGl2Pjtcblx0XHRcdDxkaXYgY2xhc3M9XCJib2FyZC1yb3dcIj5cblx0XHRcdFx0cmVuZGVyU3F1YXJlKDYpO1xuXHRcdFx0XHRyZW5kZXJTcXVhcmUoNyk7XG5cdFx0XHRcdHJlbmRlclNxdWFyZSg4KTtcblx0XHRcdDwvZGl2Pjtcblx0XHQ8L2Rpdj47XG5cdH07XG59KTtcblxuY3JlYXRlVGFnKFwianVtcFRvXCIsIChhdHRyOiBbXSwgY2hpbGRyZW46IFtdKSB7XG5cdHB1YmxpYyBsaXN0ZW5lcnMgPSBbY2xpY2s6IGF0dHIub25DbGlja107XG5cdHB1YmxpYyByZW5kZXIgPSB7XG5cdFx0cmV0dXJuIDxidXR0b24+Y2hpbGRyZW5bMF07PC9idXR0b24+O1xuXHR9O1xufSk7XG5cbmNyZWF0ZVRhZyhcIkdhbWVcIiwge1xuXHRwdWJsaWMgc3RhdGUgPSBbXG5cdFx0aGlzdG9yeTogW1xuXHRcdFx0W3NxdWFyZXM6IFsnJ10gKiA5XVxuXHRcdF0sXG5cdFx0YWN0aXZlUGxheWVyOiBcIlhcIixcblx0XHRzdGVwTnVtYmVyOiAwXG5cdF07XG5cblx0bGV0IGdldFdpbm5lciA9IChzcXVhcmVzOiBbXSkge1xuXHRcdGxldCBsaW5lcyA9IFtcblx0XHRcdFswLCAxLCAyXSxcblx0XHRcdFszLCA0LCA1XSxcblx0XHRcdFs2LCA3LCA4XSxcblx0XHRcdFswLCAzLCA2XSxcblx0XHRcdFsxLCA0LCA3XSxcblx0XHRcdFsyLCA1LCA4XSxcblx0XHRcdFswLCA0LCA4XSxcblx0XHRcdFsyLCA0LCA2XVxuXHRcdF07XG5cdFx0bGV0IHJlc3VsdCA9IFwiXCI7XG5cdFx0ZWFjaChsaW5lcywgKGxpbmU6IFtdLCBpbmRleDogMCwgYnJlYWs6IHt9KSB7XG5cdFx0XHRsZXQgW2EsIGIsIGNdID0gbGluZTtcblx0XHRcdGlmIChzcXVhcmVzW2FdIGlzbnQgXCJcIiBhbmQgc3F1YXJlc1thXSBpcyBzcXVhcmVzW2JdIGFuZCBzcXVhcmVzW2FdIGlzIHNxdWFyZXNbY10sIHtcblx0XHRcdFx0cmVzdWx0ID0gc3F1YXJlc1thXTtcblx0XHRcdFx0YnJlYWsoKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHRcdHJldHVybiByZXN1bHQ7XG5cdH07XG5cblx0bGV0IGp1bXBUbyA9IChzdGVwOiAwKSB7XG5cdFx0c2V0U3RhdGUoW1xuXHRcdFx0c3RlcE51bWJlcjogc3RlcCxcblx0XHRcdGFjdGl2ZVBsYXllcjogaWYoc3RlcCAlIDIgaXMgMCwge3JldHVybiBcIlhcIjt9LCB7cmV0dXJuIFwiT1wiO30pXG5cdFx0XSk7XG5cdH07XG5cblx0cHVibGljIGhhbmRsZUNsaWNrID0gKGk6IDApIHtcblx0XHRsZXQgaGlzdG9yeSA9IHN0YXRlLmhpc3RvcnlbOnN0YXRlLnN0ZXBOdW1iZXIgKyAxXTtcblx0XHRsZXQgY3VycmVudCA9IGhpc3RvcnlbaGlzdG9yeS5zaXplIC0gMV07XG5cdFx0bGV0IHNxdWFyZXMgPSBjdXJyZW50LnNxdWFyZXNbOl07XG5cdFx0cmV0dXJuIChlOiBbXSkge1xuXHRcdFx0aWYoc3F1YXJlc1tpXSBpcyBcIlwiIGFuZCBnZXRXaW5uZXIoc3F1YXJlcykgaXMgXCJcIiwge1xuXHRcdFx0XHRzcXVhcmVzW2ldID0gc3RhdGUuYWN0aXZlUGxheWVyO1xuXHRcdFx0XHRoaXN0b3J5ICs9IFtzcXVhcmVzOiBzcXVhcmVzXTtcblx0XHRcdFx0c2V0U3RhdGUoW1xuXHRcdFx0XHRcdGhpc3Rvcnk6IGhpc3RvcnksXG5cdFx0XHRcdFx0YWN0aXZlUGxheWVyOiBpZiAoc3RhdGUuYWN0aXZlUGxheWVyIGlzIFwiWFwiLCB7cmV0dXJuIFwiT1wiO30sIHtyZXR1cm4gXCJYXCI7fSksXG5cdFx0XHRcdFx0c3RlcE51bWJlcjogaGlzdG9yeS5zaXplIC0gMVxuXHRcdFx0XHRdKTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdH07XG5cblx0cHVibGljIHJlbmRlciA9IHtcblx0XHRsZXQgaGlzdG9yeSA9IHN0YXRlLmhpc3Rvcnk7XG5cdFx0bGV0IGN1cnJlbnQgPSBoaXN0b3J5W3N0YXRlLnN0ZXBOdW1iZXJdO1xuXHRcdGxldCB3aW5uZXIgPSBnZXRXaW5uZXIoY3VycmVudC5zcXVhcmVzKTtcblx0XHRsZXQgbW92ZXMgPSBlYWNoKGhpc3RvcnksICh2YWw6IFtdLCBtb3ZlOiAwKSB7XG5cdFx0XHRsZXQgZGVzYyA9IGlmKG1vdmUsIFxuXHRcdFx0XHR7cmV0dXJuIFwiR28gdG8gbW92ZSAjXCIgKyBtb3ZlO30sIFxuXHRcdFx0XHR7cmV0dXJuIFwiR28gdG8gZ2FtZSBzdGFydFwiO30pO1xuXHRcdFx0cmV0dXJuIDxsaT5cblx0XHRcdFx0PGp1bXBUbyBvbkNsaWNrPXtqdW1wVG8obW92ZSk7fT5kZXNjOzwvanVtcFRvPjtcblx0XHRcdDwvbGk+O1xuXHRcdH0pO1xuXHRcdGxldCBzdGF0dXMgPSBpZiAod2lubmVyIGlzbnQgXCJcIiwge1xuXHRcdFx0cmV0dXJuIFwiV2lubmVyOiBcIiArIHdpbm5lcjtcblx0XHR9LCB7XG5cdFx0XHRyZXR1cm4gXCJOZXh0IFBsYXllcjogXCIgKyBzdGF0ZS5hY3RpdmVQbGF5ZXI7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gPGRpdiBjbGFzcz1cImdhbWVcIj5cblx0XHRcdDxkaXYgY2xhc3M9XCJnYW1lLWJvYXJkXCI+XG5cdFx0XHRcdDxCb2FyZCBzcXVhcmVzPWN1cnJlbnQuc3F1YXJlcyBvbkNsaWNrPWhhbmRsZUNsaWNrIC8+O1xuXHRcdFx0PC9kaXY+O1xuXHRcdFx0PGRpdiBjbGFzcz1cImdhbWUtaW5mb1wiPlxuXHRcdFx0XHQ8ZGl2PnN0YXR1czs8L2Rpdj47XG5cdFx0XHRcdDxvbD5tb3Zlczs8L29sPjtcblx0XHRcdDwvZGl2Pjtcblx0XHQ8L2Rpdj47XG5cdH07XG59KTtcblxucmV0dXJuIGdldEFsbFRhZ3MoKTsiXX0=